<div class="dialog-content">
  <div class="dialog-body">
    <div class="header">
      <span>Sharing {{shareItem.displayName}}</span>
      <button class="btn" (click)="onDoneClick()">
        <i class="material-icons">close</i>
      </button>
    </div>
    <div class="content">
      <div class="archive-search" *ngIf="canShare">
        <pr-archive-search-box class="archive-search-box"
          (archiveSelect)="onAddArchive($event)"
          (invite)="onAddInvite($event)"
        ></pr-archive-search-box>
        <select class="form-control" [(ngModel)]="newAccessRole">
          <option *ngFor="let option of accessRoleOptions" [value]="option.value">{{option.text}}</option>
        </select>
      </div>
      <ng-container *ngIf="!shares || !shares.length">
        <div class="shares-empty">Not shared with anyone</div>
      </ng-container>
      <ng-container *ngIf="shares?.length">
        <div class="shares-title">Shared with</div>
        <div class="shares">
          <div class="share-archive pending-share" *ngFor="let share of pendingShares"
            [@ngIfScaleAnimationDynamic]="(share.isPendingAction || share.isNewlyCreated) ? 'animate' : 'static'">
            <div class="archive-thumb" prBgImage [bgSrc]="share.ArchiveVO.thumbURL200" [cover]="true"></div>
            <div class="archive-name">The {{share.ArchiveVO.fullName}} Archive
              <div class="subtitle">Requested {{share.createdDT | date}}</div>
            </div>
            <div class="archive-actions">
              <button class="btn btn-primary"
                [disabled]="share.isPendingAction"
                (click)="approveShare(share)">
                Approve
              </button>
              <button class="btn btn-danger"
                [disabled]="share.isPendingAction"
                (click)="removeShare(share)">
                Deny
              </button>
            </div>
          </div>
          <div class="share-archive" *ngFor="let share of shares"
            [@ngIfScaleAnimationDynamic]="(share.isPendingAction || share.isNewlyCreated) ? 'animate' : 'static'">
            <div class="archive-thumb" prBgImage [bgSrc]="share.ArchiveVO.thumbURL200" [cover]="true"></div>
            <div class="archive-name">The {{share.ArchiveVO.fullName}} Archive</div>
            <select class="form-control" [disabled]="!canShare || share.accessRole === 'access.role.owner' || share.isPendingAction"
              [(ngModel)]="share.accessRole" (ngModelChange)="onAccessChange(share, ctrl)" #ctrl="ngModel">
              <option *ngFor="let option of accessRoleOptions" [value]="option.value">{{option.text}}</option>
              <option value="remove">Remove</option>
            </select>
          </div>
        </div>
      </ng-container>
    </div>
  </div>
  <div class="dialog-body" *ngIf="canShare">
    <div class="header-small">Share link</div>
    <div class="content">
      <div class="share-link">
        <div class="share-link-container" *ngIf="shareLink">
          <input type="text" class="form-control" readonly [value]="shareLink.shareUrl" #shareUrlInput>
        </div>
        <button class="btn btn-primary-light" *ngIf="shareLink" [disabled]="linkCopied" (click)="copyShareLink()">
          {{ linkCopied ? 'Copied' : 'Copy'}}
        </button>
        <div class="share-link-container" *ngIf="!shareLink">
          Generate a link to send via text or email to invite people to share this content.
        </div>
        <button class="btn btn-primary-light" (click)="generateShareLink()" *ngIf="!shareLink">
          Create
        </button>
      </div>
      <div class="share-link-settings-toggle" *ngIf="shareLink">
        <button class="btn btn-link" (click)="showLinkSettings = !showLinkSettings">
          {{showLinkSettings ? 'Hide' : 'Show'}} link settings
        </button>
      </div>
      <div class="share-link-settings" *ngIf="showLinkSettings" @ngIfScaleAnimation>
        <div class="link-settings-item">
          <label>Share Preview</label>
          <div class="form-check form-check-inline">
            <input class="form-check-input" type="radio" name="sharePreviewToggle" id="sharePreviewToggleOn"
            [value]="1" [disabled]="updatingLink"
            [(ngModel)]="previewToggle" (ngModelChange)="onPreviewToggleChange()">
            <label class="form-check-label" for="sharePreviewToggleOn">On</label>
          </div>
          <div class="form-check form-check-inline">
            <input class="form-check-input" type="radio" name="sharePreviewToggle" id="sharePreviewToggleOff"
            [value]="0" [disabled]="updatingLink"
            [(ngModel)]="previewToggle" (ngModelChange)="onPreviewToggleChange()">
            <label class="form-check-label" for="sharePreviewToggleOff">Off</label>
          </div>
        </div>
        <small class="text-muted" [ngSwitch]="previewToggle">
            <ng-container *ngSwitchCase="1">
            Recipients can see a preview without being logged in.
          </ng-container>
          <ng-container *ngSwitchCase="0">
            Recipients must be granted access to view content.
          </ng-container>
        </small>
        <div class="link-settings-item">
          <label>Link expires after</label>
          <select class="form-control" [disabled]="!canShare || updatingLink"
            [(ngModel)]="expiration" (ngModelChange)="onExpirationChange()">
            <option *ngFor="let option of expirationOptions" [value]="option.value" [hidden]="option.value === 'Other'">{{option.text}}</option>
          </select>
        </div>
        <small class="text-muted" [ngSwitch]="shareLink.expiresDT">
          <ng-container *ngSwitchCase="null">
            This link will never expire
          </ng-container>
          <ng-container *ngSwitchDefault>
            This link will expire {{shareLink.expiresDT | date: 'MMM d, y \'at\' h:mm:ss a'}}
          </ng-container>
        </small>
      </div>
      <!-- <div class="share-link" *ngIf="shareLink">
        <p>Send this link via text, email, or other message service to invite people to share this content.</p>
          <input type="text" class="form-control" readonly [value]="shareLink.shareUrl" #shareUrlInput>
          <button class="btn btn-primary" [disabled]="linkCopied" (click)="copyShareLink()">{{ linkCopied ? 'Link copied' : 'Copy link'}}</button>
          <button class="btn btn-primary" (click)="manageShareLink()">Manage link</button>
          <button class="btn btn-danger" (click)="removeShareLink()">Remove link</button>
      </div>
      <div class="share-link-button" *ngIf="!shareLink">
        <button class="btn btn-primary" (click)="generateShareLink()">Get share link</button>
      </div> -->
    </div>
  </div>
</div>