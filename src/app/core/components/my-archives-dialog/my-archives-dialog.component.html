<div class="dialog-content">
	<div class="header">
		<span>My Archives</span>
		<button class="btn" (click)="onDoneClick()">
			<i class="material-icons">close</i>
		</button>
	</div>
	<div class="content">
		<div class="tabs">
			<div
				class="dialog-tab"
				(click)="setTab('switch')"
				[class.active]="activeTab === 'switch'"
			>
				Switch Archives
			</div>
			<div
				class="dialog-tab"
				(click)="setTab('pending')"
				[class.active]="activeTab === 'pending'"
			>
				Pending Archives
			</div>
			<div
				class="dialog-tab"
				(click)="setTab('new')"
				[class.active]="activeTab === 'new'"
			>
				New Archive
			</div>
		</div>
		<div class="panel" #panel>
			@switch (activeTab) {
				@case ('switch') {
					<div class="panel-title">({{ archives.length }}) Archives</div>
					@for (archive of archives; track archive) {
						<pr-archive-small
							(archiveClick)="onArchiveClick(archive)"
							[clickable]="true"
							[showAccept]="account.defaultArchiveId !== archive.archiveId"
							acceptText="Make Default"
							acceptIcon="star"
							(acceptClick)="onArchiveMakeDefaultClick(archive)"
							[showRemove]="
								archive.accessRole.includes('owner') &&
								currentArchive.archiveId !== archive.archiveId &&
								account.defaultArchiveId !== archive.archiveId &&
								archives.length > 1
							"
							removeText="Delete Archive"
							(removeClick)="onArchiveDeleteClick(archive)"
							[largeOnDesktop]="true"
							[archive]="archive"
							[actionsAsDropdown]="true"
							[accessRole]="archive.accessRole"
							[class.waiting]="archive.isPendingAction"
						></pr-archive-small>
					}
				}
				@case ('pending') {
					<div class="panel-title">
						({{ pendingArchives.length }}) Pending Archives
					</div>
					@if (!pendingArchives.length) {
						<div>No pending archives</div>
					}
					@for (archive of pendingArchives; track archive) {
						<pr-archive-small
							[largeOnDesktop]="true"
							[archive]="archive"
							[accessRole]="archive.accessRole"
							[showAccept]="true"
							(acceptClick)="acceptPendingArchive(archive)"
							[showRemove]="true"
							removeText="Decline"
							(removeClick)="declinePendingArchive(archive)"
						>
						</pr-archive-small>
					}
				}
				@case ('new') {
					<pr-new-archive-form
						[showRelations]="true"
						(success)="onNewArchiveFormSubmit($event)"
						(errorOccurred)="onNewArchiveFormFailure($event)"
					></pr-new-archive-form>
				}
			}
		</div>
	</div>
</div>
